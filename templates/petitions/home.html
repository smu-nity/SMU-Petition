{% extends 'base.html' %}
{% load static %}
{% load petitions_filter %}
{% block content %}
    <div style="background-color : #ebecf0;">
        <div class="navbar-img">
            <img class="main-img-image"/>

            <div class="navbar-img__text">
                <!--ë™ì˜í•˜ê¸°, ì²­ì›í•˜ê¸° ë²„íŠ¼-->
                <div class="col-5 enroll-btn display-none" style="padding-top : 10rem;">
                    <a href="{% url 'petitions:petition_create' %}" class="btn btn-primary navbarMain-button">
                        <i class="fas fa-pen enroll-btn__icon" ></i>
                        <span>ì²­ì›í•˜ê¸°</span>
                    </a>
                    <a href="{% url 'petitions:petition_list' 'progress'%}" class="btn btn-primary navbarMain-button">
                        <i class="fas fa-thumbs-up enroll-btn__icon"></i>
                        <span>ë™ì˜í•˜ê¸°</span>
                    </a>
                </div>
            </div>
        </div>
        {% if petition_list %}
            <div id="box_board" >

            <!--MarginSide-->
            <div style="height : 40px;"> </div>

            <div class="container container-home main-div " style="width : 70%;">

            <!--ë³´ê¸° ì˜µì…˜-->
            <nav>
              <div class="nav nav-tabs main-search-option " style="width: 99.3%;" id="nav-tab" role="tablist">
                <!--ìµœë‹¤ ë™ì˜ ìˆœ ë²„íŠ¼-->
                <a class="nav-item nav-link nav-tab active" id="nav-home-tab" data-toggle="tab" href="#nav-home" role="tab" aria-controls="nav-home" aria-selected="true">
                    <i class="fas fa-thumbs-up "></i>
                    ìµœë‹¤ ë™ì˜ ìˆœ
                </a>

                <!--ë§Œë£Œ ì„ë°• ìˆœ ë²„íŠ¼-->
                <a class="nav-item nav-link nav-tab" id="nav-profile-tab" data-toggle="tab" href="#nav-profile" role="tab" aria-controls="nav-profile" aria-selected="false">
                    <i class="far fa-calendar-times"></i>
                    ë§Œë£Œ ì„ë°• ìˆœ
                </a>

                <!--ìµœê·¼ ê³µê°œ ìˆœ ë²„íŠ¼-->
                <a class="nav-item nav-link nav-tab" id="nav-contact-tab" data-toggle="tab" href="#nav-contact" role="tab" aria-controls="nav-contact" aria-selected="false">
                    <i class="fas fa-calendar-plus"></i>
                    ìµœê·¼ ê³µê°œ ìˆœ
                </a>
              </div>
            </nav>

            <!--ì˜µì…˜ ë§í¬-->
            <div class="tab-content" id="nav-tabContent">
                {% for pl in petition_list %}
                    <div
                         {% if forloop.counter == 1 %}
                            class="tab-pane fade show active"
                            id="nav-home" aria-labelledby="nav-home-tab"
                         {% elif forloop.counter == 2 %}
                            class="tab-pane fade show"
                            id="nav-profile" aria-labelledby="nav-profile-tab"
                         {% else %}
                            class="tab-pane fade show"
                            id="nav-contact" aria-labelledby="nav-contact-tab"
                         {% endif %}
                         role="tabpanel">

                <!--TOP 1 ê°œì‹œê¸€-->
                <div class="main-top1-div">
                    <div class="card" style="width :98.5%;">

                        <!--TOP 1 Header-->
                        <div class="card-header main__top1-card-header" style="height : 70px;">

                            <!--TOP 1 Header-ë™ì˜ê¸°ê°„-->
                            <div class="card-info">
                                <span class="top1-header">{{ pl.top1.get_category_display }} |</span>
                                <span class="top1-header" style="color: orange;">{{ pl.top1.get_status_display }}</span>
                                <span class="top1-header">{{ pl.top1.d_day }}</span>
                            </div>

                            <div class="card-date">
                                <i class="far fa-calendar-check" style="font-size: 20px;"></i>
                                <span class="top1-date">ì²­ì› ê¸°ê°„: {{ pl.top1.period_str }}</span>
                            </div>
                        </div>


                        <!--TOP 1 Body-->
                        <a href="{% url 'petitions:petition_detail' pl.top1.id %}" class="card-body main__top1-card-body card-body-top" style="font-weight: normal; cursor: pointer;">
                            <div>
                                 <h5 class="card-title main-hot1-title-font" >
                                    <span>{{ pl.top1.subject }}</span>
                                </h5>
                                <div style="padding : 4px;"> </div>
                                <p class="card-text main-Top1-Body-card-text-box post_detail__body-text">
                                    {{ pl.top1.content|mark }}
                                </p>
                            </div>
                        </a>

                        <div class="card-header" style="height : 50px; background-color: white; display : flex;">
                            <!--TOP 1 Header-ë™ì˜ ì‚¬ëŒ-->
                            <div class="card-agree">
                                <i class="fas fa-thumbs-up " style="align-item: center; font-size: 20px; color: #6499E1" ></i>
                                <span style="font-size: 15px; color: #6499E1;">{{ pl.top1.voter.count }}ëª…</span>
                                <span style="font-size: 15px; color: #6499E1; margin-left: 5px;">({{ pl.top1.get_percentage }}%)</span>
                            </div>
                        </div>

                        <!--TOP 1 Foot-->
                        <div class="card-footer text-muted card-footer-setting" >
                          <div class="progress" style="height:25px">
                              <!--ë§‰ëŒ€ê¸° í¼ì„¼íŠ¸ ì¡°ì ˆ í•˜ê³  ì‹¶ìœ¼ë©´ home.css ì— ê°€ì„œ main_progress-bar-stats ì— ìˆëŠ” width ë¥¼ ë³€ê²½í•˜ë©´ ëœë‹¤. ë‹ˆë¨¸ì§€ë“¤ ëª¨ë‘ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì§„í–‰   // ì´ ë°”ë¡œ ì•„ë˜ 65%ëŠ” ë§‰ëŒ€ê¸° ì† ìˆ«ìë¥¼ ì˜ë¯¸-->
                            <div class="progress-bar main_progress-bar-stats" role="progressbar" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100" style="width: {{ pl.top1.get_percentage }}%;">
                                {% if pl.top1.get_percentage >= 5 %}
                                    {{ pl.top1.get_percentage }} %
                                {% endif %}
                            </div>
                          </div>
                        </div>
                    </div>
                </div>



                <!--TOP1 TOP 2 ì‚¬ì´ ê³µê°„-->
                {% if top2_3 %}
                    <div class="home-margin-30"></div>
                    <div class="home__container-remnant" style="display: flex; justify-content : space-evenly;">
                        {% for petition in pl.top2_3 %}
                            {% if petition %}
                            <div class="card text-right home__container-remnant-top2" style="width: 49%; text-decoration: none; color: black;">
                                <div class="card text-center">
                                <!--HOT 2 Head-->
                                  <div class="card-header main__top1-card-header" style="display : flex; justify-content : space-between;">
                                    <div class="card-info">
                                        <span class="top23-header">{{ petition.get_category_display }} |</span>
                                        <span class="top23-header" style="color: orange;">{{ petition.get_status_display }}</span>
                                        <span class="top23-header">{{ petition.d_day }}</span>
                                    </div>

                                      <div class="card-date">
                                        <i class="far fa-calendar-check " style="font-size: 15px;"></i>
                                        <span class="top23-date"> ì²­ì› ê¸°ê°„: {{ petition.period_str }}</span>
                                      </div>
                                  </div>
                                </div>
                                <!--HOT 2 Body-->
                                <a href="{% url 'petitions:petition_detail' petition.id %}" class="card-body main-hot23-body card-body-top" style="cursor: pointer;">
                                    <span class="card-title main-card-title-font">{{ petition.subject }}</span>
                                </a>
                                <!--HOT 2 ë™ì˜ ì‚¬ëŒ ìˆ˜-->
                                <div class="card-header" style="display : flex; justify-content : space-between; background-color: white;">
                                    <div class="card-agree">
                                        <i class="fas fa-thumbs-up" style=" color : #6499E1;"></i>
                                        <span style="font-size: 15px; color: #6499E1;">{{ petition.voter.count }}ëª…</span>
                                        <span style="font-size: 15px; color: #6499E1; margin-left: 5px;">({{ petition.get_percentage }}%)</span>
                                    </div>
                                </div>
                                <!--HOT 2 Foot-->
                                <div class="card-footer text-muted card-footer-setting" style="background-color : #cdd0da; justify-content: center; padding: 8px 12px 6px 12px;">
                                  <div class="progress" style="height: 20px;">
                                    <div class="progress-bar" role="progressbar" style="width: {{ petition.get_percentage }}%; background-color: #6499E1;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">
                                        {% if petition.get_percentage >= 5 %}
                                            {{ petition.get_percentage }} %
                                        {% endif %}
                                    </div>
                                  </div>
                                </div>
                            </div>
                            {% else %}
                            <div class="card text-right home__container-remnant-top2" style="width: 49%;">
                                <div class="card text-center">
                                <!--HOT 2 Head-->
                                  <div class="card-header main__top1-card-header" style="display : flex; justify-content : space-between;">
                                    <div>
                                        <span style="font-size : 15px">ì§„í–‰ì¤‘ì¸ ì²­ì› ì—†ìŒ</span>
                                    </div>
                                  </div>
                                </div>
                                <!--HOT 2 Body-->
                                <div class="card-body main-hot23-body" ></div>
                                <!--HOT 2 ë™ì˜ ì‚¬ëŒ ìˆ˜-->
                                <div class="card-header" style="display : flex; justify-content : space-between; background-color: white;"></div>
                                <!--HOT 2 Foot-->
                                <div class="card-footer text-muted card-footer-setting" style="background-color : #cdd0da; justify-content: center; ">
                                  <div class="progress" style="height: 20px;">
                                    <div class="progress-bar" role="progressbar" style="width: 0%; background-color: #6499E1;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                  </div>
                                </div>
                            </div>
                            {% endif %}
                        {% endfor %}
                    </div>
                {% endif %}
                </div>
            {% endfor %}
        </div>

            <div class="home-margin-top"> </div>
        </div>
        </div>
        {% endif %}
        {% if petition_list %}
        <div id="category" class="container container-home main-div category">
        {% else %}
        <div id="category" class="container container-home main-div" style="margin-top: 2rem;">
        {% endif %}
            <!--í•­ëª© ë³„ ë¶„ë¥˜ ë²„íŠ¼ ì„¸íŠ¸ -->
            <div style="display : flex; justify-content: space-between;" >

                    <!--í•™ì‚¬ ë²„íŠ¼-->
                    <div class="main-search-by-category-icon-div">
                        <a class="btn-primary main-search-by-category-icon" href="javascript:void(0);" onclick="changeCategory(1);" role="button">
                            <i class="fas fa-user-graduate main-search-by-category-icon-details"></i>
                        </a>
                        <span class="main-search-by-category-icon-font">í•™ì‚¬</span>
                    </div>

                    <!--ë“±ë¡/ì¥í•™ ë²„íŠ¼ -->
                    <div class="main-search-by-category-icon-div">
                        <a class="btn-primary main-search-by-category-icon " href="javascript:void(0);" onclick="changeCategory(2);" role="button">
                            <i class="fas fa-won-sign main-search-by-category-icon-details" ></i>
                        </a>
                        <span class="main-search-by-category-icon-font">ë“±ë¡/ì¥í•™</span>
                    </div>

                    <!--í•™ìƒ ìƒí™œ ë²„íŠ¼ -->
                    <div class="main-search-by-category-icon-div">
                        <a class="btn-primary main-search-by-category-icon " href="javascript:void(0);" onclick="changeCategory(3);" role="button">
                            <i class="fas fa-university main-search-by-category-icon-details"></i>
                        </a>
                        <span class="main-search-by-category-icon-font">í•™ìƒìƒí™œ</span>
                    </div>

                    <!--ì§„ë¡œì·¨ì—… ë²„íŠ¼ -->
                    <div class="main-search-by-category-icon-div">
                        <a class="btn-primary main-search-by-category-icon " href="javascript:void(0);" onclick="changeCategory(4);" role="button">
                            <i class="fas fa-briefcase main-search-by-category-icon-details"></i>
                        </a>
                        <span class="main-search-by-category-icon-font">ì§„ë¡œì·¨ì—…</span>
                    </div>

                    <!--ê¸°íƒ€ ë²„íŠ¼ -->
                    <div class="main-search-by-category-icon-div">
                        <a class="btn-primary main-search-by-category-icon " href="javascript:void(0);" onclick="changeCategory(5);" role="button">
                            <i class="fas fa-question-circle main-search-by-category-icon-details"></i>
                        </a>
                        <span class="main-search-by-category-icon-font">ê¸°íƒ€</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ê³µì§€ì‚¬í•­ -->
    <div id='myModal' class="modal" style="display: none;">
        <div class="modal-content">
            <span id='dd' class="close" style="font-size:3rem;">&times;</span>
            <div class='popup_content'>
                <div class='popup_title'>
                    ê³µì§€ì‚¬í•­
                </div>
                <div class='popup_box'>
                    <ul style="padding-left: 0;">
                        ìƒëª…ëŒ€í•™êµ ì„œìš¸ìº í¼ìŠ¤ í•™ìš° ì—¬ëŸ¬ë¶„, ì•ˆë…•í•˜ì‹­ë‹ˆê¹Œ. ì œ46ëŒ€ ì´í•™ìƒíšŒ ì„ [å…ˆ] ì…ë‹ˆë‹¤.<br><br>

                        ë³¸ ì´í•™ìƒíšŒì—ì„œëŠ” í•™ìš° ì—¬ëŸ¬ë¶„ê»˜ ë‹¤ì–‘í•œ ì‚¬ì—… ì •ë³´ì˜ ì „ë‹¬ ë° í¸ì˜ê¸°ëŠ¥ ì œê³µì„ ëª©ì ìœ¼ë¡œ í•˜ëŠ” ì†Œí†µì°½êµ¬, ì´í•™ìƒíšŒ ë©”ì¸ í™ˆí˜ì´ì§€ì™€ í•™ìƒ ê±´ì˜/ì²­ì› ê²Œì‹œíŒì„ ìš´ì˜í•˜ê³  ìˆìŠµë‹ˆë‹¤.<br><br>

                        ë³¸ ê±´ì˜/ì²­ì› ê²Œì‹œíŒì„ í†µí•´ í•™ìš° ì—¬ëŸ¬ë¶„ê³¼ í•¨ê»˜ ë³€í™”í•˜ëŠ” í•™êµë¡œì˜ ë„ì•½ì„ ì‹¤í˜„í•  ìˆ˜ ìˆë„ë¡ ë…¸ë ¥í•˜ê² ìŠµë‹ˆë‹¤.<br>
                        ìì„¸í•œ ë‚´ìš©ì€ ê±´ì˜/ì²­ì› í˜ì´ì§€ ë‚´ ì´ìš©ì•½ê´€ì„ ì°¸ê³ í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤.<br><br>

                        í•™ìš° ì—¬ëŸ¬ë¶„ì´ ì „í•´ì£¼ì‹œëŠ” ëª©ì†Œë¦¬ì— í•­ìƒ ê·€ ê¸°ìš¸ì´ê³ , ë³€í™”í•˜ëŠ” í•™êµë¥¼ ë§Œë“¤ê¸° ìœ„í•´ ëŠì„ì—†ì´ ë…¸ë ¥í•˜ê² ìŠµë‹ˆë‹¤.<br>
                        ê°ì‚¬í•©ë‹ˆë‹¤.<br><br>

                        ğŸ«§ ê·¸ëŒ€ ì™¸ì¹¨ ë‹¿ì„ ë•Œê¹Œì§€, í•œ ê±¸ìŒ ì•ì— ë¨¼ì € ì„ [å…ˆ] ğŸ«§
                        <hr style='border: 0.001px solid rgb(230, 230, 230); margin:1rem 0 1rem 0; width:100%; opacity: inherit'>
                        <li class="modal-li">
                            <b>ì´ìš©ì•½ê´€ ë° ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</b>&nbsp;&nbsp;
                            <a class="link_site" href="{% url 'qna:terms' %}">ì´ìš©ì•ˆë‚´</a>
                        </li>
                        <li class="modal-li">
                            <b>ìƒëª…ëŒ€í•™êµ ì„œìš¸ìº í¼ìŠ¤ ì œ46ëŒ€ ì´í•™ìƒíšŒ ì„ [å…ˆ]</b>&nbsp;&nbsp;
                            <a class="link_site" target="_blank" href="https://www.student-smu.com">ìƒëª…ëŒ€í•™êµ ì´í•™ìƒíšŒ</a>
                        </li>
                        <li class="modal-li">
                            <b>ìƒëª…ëŒ€í•™êµ ì¡¸ì—…ìš”ê±´ ê²€ì‚¬</b>&nbsp;&nbsp;
                            <a class="link_site" target="_blank" href="https://smunity.co.kr/">ìŠ¤ë®¤ë‹ˆí‹°</a>
                        </li>
                    </ul>
                </div>
                <div class="popup_check">
                    <label style='cursor:pointer'>
                        <input id='unlook' type="checkbox" style='width:1rem; height:1rem;'>
                        <label for='unlook'></label>
                        &nbsp;ì¼ì£¼ì¼ê°„ íŒì—… ë³´ì§€ ì•Šê¸°
                    </label>

                </div>
            </div>
        </div>
    </div>
{% endblock %}
{% block script %}
    <script src="{% static 'js/modal.js' %}"></script>
    <script>
        function changeCategory(category) {
            let params = new URLSearchParams();
            params.set("category", category);
            window.open("{% url 'petitions:petition_list' 'progress'%}" + '?' + params, '_self');
        }
    </script>
{% endblock %}